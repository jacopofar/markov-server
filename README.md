This application exposes a RESTful API to train and use Markov chains.

__NOTE: this is an alpha version, it has basic functionalities and passes the few tests defined but it's not robust nor fancy__

Features:
* multiple independent chains
* arbitrary order of the model
* persist as much states you like on PostgreSQL (version 9.5 or later are needed, it uses the INSERT...ON CONFLICT... aka UPSERT)
* accept sequences in JSON and text (MSGPACK yet to be tested)
* UTF-8 support
* reasonably fast: on my laptop (dual core, 8GB RAM, no SSD) loads ~100 reddit posts per second.

How to use:
-----------
probably the easiest way to start from zero is to use Docker.

Start a postgres container with:

`docker run --name markov-postgres -p 5432:5432 -e POSTGRES_PASSWORD=mysecretpassword -d postgres:9.5`

then launch the application container with:
`docker run --link markov-postgres -e "postgresConnString=postgres://postgres:mysecretpassword@markov-postgres/postgres" jacopofar/markov-server`

and if you want to inspect the running database:

`docker run -it --link markov-postgres:postgres --rm postgres:9.5 sh -c 'exec psql -h "$POSTGRES_PORT_5432_TCP_ADDR" -p "$POSTGRES_PORT_5432_TCP_PORT" -U postgres'`

Alternatively, you can just run he application with `npm start`, or a command like

`node index.js --writePort 3002 --postgresConnString 'postgres://postgres:mysecretpassword@my_postgres_host/postgres'`

the flags are all optionals, environment variables can be used too. The arguments are:


| Name   | Description             | default value |
|--------:|------------------------|---------------|
|writePort |the port for the insertion endpoints| 3000|
|metaDataPort | the port for the metadata endpoints| 3001|
|readPort |the port to read endpoints| 3002|
|postgresConnString | the postgres connection string |postgres://postgres:mysecretpassword@127.0.0.1/postgres |
|maxPendingInsertions |maximum number of concurrent insertions, then the server will answer with a HTTP 429| 5|
|CORS| Whether to accept cross origin requests| true|

Usage
-----
See the endpoints folder, a proper API has yet to be defined and documented

 TO DO:
-------
 * test MSGPACK and maybe other formats
 * write a proper API documentation (autogenerated? using JSON-schema maybe?)
 * add metadata endpoints
 * add an in-memory "persistor"
 * add a Redis persistor
